version: '3.8'

services:
  postgres:
    command: postgres
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

  redis:
    command: redis-server --appendonly yes --loglevel debug

  backend:
    environment:
      - XDEBUG_MODE=develop,coverage
      - XDEBUG_CONFIG=client_host=host.docker.internal
    volumes:
      - ./backend/storage/logs:/var/www/html/storage/logs
      - ./backend/storage/app:/var/www/html/storage/app

  frontend:
    environment:
      - NEXT_PUBLIC_DEBUG=true
      - NEXT_PUBLIC_ANALYTICS=false
    volumes:
      - ./frontend/.next:/app/.next
